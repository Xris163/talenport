import { NextRequest, NextResponse } from 'next/server';import { createClient } from '@supabase/supabase-js';export async function GET(req:NextRequest){const q=new URL(req.url).searchParams.get('q')||'';const sb=createClient(process.env.SUPABASE_URL as string, process.env.SUPABASE_SERVICE_KEY as string);if(!q){const {data}=await sb.from('jobs').select('*').eq('status','published').limit(20);return NextResponse.json({jobs:data||[]})}const {data,error}=await sb.rpc('search_jobs',{q});if(error)return NextResponse.json({error:error.message},{status:400});return NextResponse.json({jobs:data})}